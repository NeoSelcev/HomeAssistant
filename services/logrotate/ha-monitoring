# Logrotate configuration for HA monitoring system logs
# Place this file in /etc/logrotate.d/ha-monitoring

# High-frequency logs (every 2-5 minutes) - more aggressive rotation
/var/log/ha-watchdog.log
/var/log/ha-failures.log
/var/log/ha-failure-notifier.log {
    # Rotate when file reaches 5MB (currently 4.8MB and 37MB!)
    size 5M
    
    # Keep 10 rotated files (50MB total per log)
    rotate 10
    
    # Compress rotated files to save space
    compress
    
    # Don't compress the most recent rotated file (faster access)
    delaycompress
    
    # Don't rotate if file is empty
    notifempty
    
    # Don't error if log file is missing
    missingok
    
    # Create new log file with these permissions after rotation
    create 644 root root
    
    # Rotate daily if size limit not reached
    daily
    
    # Send HUP signal to rsyslog after rotation (if needed)
    # postrotate
    #     /bin/systemctl reload rsyslog.service > /dev/null 2>&1 || true
    # endscript
}

# Medium-frequency logs - moderate rotation
/var/log/ha-reboot.log
/var/log/ha-update-checker.log
/var/log/ha-update-report.log {
    # Rotate when file reaches 10MB
    size 10M
    
    # Keep 5 rotated files (50MB total per log)
    rotate 5
    
    # Compress old files
    compress
    delaycompress
    
    # Don't rotate empty files
    notifempty
    missingok
    
    # Create new file with correct permissions
    create 644 root root
    
    # Rotate weekly if size not reached
    weekly
}

# Low-frequency logs - light rotation
/var/log/ha-debug.log
/var/log/ha-services-control.log {
    # Rotate when file reaches 20MB
    size 20M
    
    # Keep 3 rotated files
    rotate 3
    
    compress
    delaycompress
    notifempty
    missingok
    create 644 root root
    
    # Rotate monthly if size not reached
    monthly
}
