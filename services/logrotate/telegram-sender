# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è logrotate –¥–ª—è Telegram Sender
# /etc/logrotate.d/telegram-sender

/var/log/telegram-sender.log {
    # –†–æ—Ç–∞—Ü–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
    size 5M
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    rotate 10
    
    # –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏
    daily
    
    # –°–∂–∞—Ç–∏–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    compress
    
    # –ù–µ —Å–∂–∏–º–∞—Ç—å –ø–µ—Ä–≤—ã–π –∞—Ä—Ö–∏–≤–Ω—ã–π —Ñ–∞–π–ª
    delaycompress
    
    # –ù–µ –≤—ã–¥–∞–≤–∞—Ç—å –æ—à–∏–±–∫—É –µ—Å–ª–∏ —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
    missingok
    
    # –ù–µ —Ä–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã
    notifempty
    
    # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
    create 644 root root
    
    # –°–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ —Ä–æ—Ç–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    postrotate
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä > 10MB)
        if [ -s "$1" ] && [ $(stat -f%z "$1" 2>/dev/null || stat -c%s "$1" 2>/dev/null || echo 0) -gt 10485760 ]; then
            /usr/local/bin/telegram-sender.sh "üìã Log rotation: telegram-sender.log rotated (size > 5MB)" 2 2>/dev/null || true
        fi
    endscript
    
    # –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—Ä–µ–∑–∞—Ç—å –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è (–¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
    copytruncate
}

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã):
# 
# –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º:
# size 2M           # –ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –±–æ–ª–µ–µ —á–∞—Å—Ç–æ–π —Ä–æ—Ç–∞—Ü–∏–∏
# rotate 15         # –ë–æ–ª—å—à–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
# hourly           # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
# maxage 30        # –£–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
# 
# –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞:
# size 10M         # –ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –º–µ–Ω–µ–µ —á–∞—Å—Ç–æ–π —Ä–æ—Ç–∞—Ü–∏–∏  
# rotate 5         # –ú–µ–Ω—å—à–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
# weekly          # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
